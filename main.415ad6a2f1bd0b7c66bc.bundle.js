webpackJsonp([1],{0:function(n,l,u){n.exports=u("cDNt")},1:function(n,l){},cDNt:function(n,l,u){"use strict";function t(n){return m._34(0,[m._30(402653184,1,{connectBtn:0}),(n()(),m._15(1,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n  login works!\n"])),(n()(),m._32(-1,null,["\n\n\n"])),(n()(),m._15(4,0,[[1,0],["connect",1]],null,1,"a",[["href","#"],["id","connect-button"],["role","button"]],null,null,null,null,null)),(n()(),m._32(-1,null,["Connect to 365"]))],null,null)}function e(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"login",[],null,null,null,t,x)),m._13(1,4243456,null,0,j,[D,w.k],null,null)],null,null)}function o(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),m._32(1,null,["\n  Hello "," !\n"]))],null,function(n,l){n(l,1,0,l.component.g.me.displayName)})}function i(n){return m._34(0,[(n()(),m._32(-1,null,["loading..."]))],null,null)}function r(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"li",[],null,null,null,null,null)),(n()(),m._32(1,null,["\n            category "," : ","\n          "]))],null,function(n,l){n(l,1,0,l.context.index,l.context.$implicit.value)})}function c(n){return m._34(0,[(n()(),m._15(0,0,null,null,5,"ul",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n          "])),(n()(),m._9(16777216,null,null,2,null,r)),m._13(3,802816,null,0,A.i,[m.Y,m.V,m.y],{ngForOf:[0,"ngForOf"]},null),m._28(4,1),(n()(),m._32(-1,null,["\n        "]))],function(n,l){n(l,3,0,m._33(l,3,0,n(l,4,0,m._26(l.parent.parent.parent,2),l.parent.context.$implicit.details.categoryDescriptions)))},null)}function s(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"li",[],null,null,null,null,null)),(n()(),m._32(1,null,["\n            ","\n          "]))],null,function(n,l){n(l,1,0,l.context.$implicit.name)})}function a(n){return m._34(0,[(n()(),m._15(0,0,null,null,4,"ul",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n          "])),(n()(),m._9(16777216,null,null,1,null,s)),m._13(3,802816,null,0,A.i,[m.Y,m.V,m.y],{ngForOf:[0,"ngForOf"]},null),(n()(),m._32(-1,null,["\n        "]))],function(n,l){n(l,3,0,l.parent.context.$implicit.buckets)},null)}function _(n){return m._34(0,[(n()(),m._15(0,0,null,null,35,"div",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n    "])),(n()(),m._15(2,0,null,null,1,"h4",[],null,null,null,null,null)),(n()(),m._32(3,null,["",""])),(n()(),m._32(-1,null,["\n    "])),(n()(),m._15(5,0,null,null,29,"ul",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n      "])),(n()(),m._15(7,0,null,null,2,"li",[],null,null,null,null,null)),(n()(),m._32(8,null,["createdBy: ",""])),m._28(9,2),(n()(),m._32(-1,null,["\n      "])),(n()(),m._15(11,0,null,null,2,"li",[],null,null,null,null,null)),(n()(),m._32(12,null,["createdDateTime: ",""])),m._28(13,2),(n()(),m._32(-1,null,["\n      "])),(n()(),m._15(15,0,null,null,2,"li",[],null,null,null,null,null)),(n()(),m._32(16,null,["owner: ",""])),m._28(17,2),(n()(),m._32(-1,null,["\n\n      "])),(n()(),m._15(19,0,null,null,6,"li",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n          categories"])),(n()(),m._15(21,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n        "])),(n()(),m._9(16777216,null,null,1,null,c)),m._13(24,16384,null,0,A.j,[m.Y,m.V],{ngIf:[0,"ngIf"]},null),(n()(),m._32(-1,null,["\n      "])),(n()(),m._32(-1,null,["\n\n\n      "])),(n()(),m._15(27,0,null,null,6,"li",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n        buckets"])),(n()(),m._15(29,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n        "])),(n()(),m._9(16777216,null,null,1,null,a)),m._13(32,16384,null,0,A.j,[m.Y,m.V],{ngIf:[0,"ngIf"]},null),(n()(),m._32(-1,null,["\n      "])),(n()(),m._32(-1,null,["\n  \n\n    "])),(n()(),m._32(-1,null,["\n\n\n  "]))],function(n,l){n(l,24,0,l.context.$implicit.details),n(l,32,0,l.context.$implicit.buckets)},function(n,l){var u=l.component;n(l,3,0,l.context.$implicit.title),n(l,8,0,m._33(l,8,0,n(l,9,0,m._26(l.parent.parent,0),l.context.$implicit.createdBy.user.id,u.g.users))),n(l,12,0,m._33(l,12,0,n(l,13,0,m._26(l.parent.parent,1),l.context.$implicit.createdDateTime,"medium"))),n(l,16,0,m._33(l,16,0,n(l,17,0,m._26(l.parent.parent,0),l.context.$implicit.owner,u.g.users)))})}function f(n){return m._34(0,[(n()(),m._15(0,0,null,null,4,"div",[],null,null,null,null,null)),(n()(),m._32(-1,null,["\n\n  "])),(n()(),m._9(16777216,null,null,1,null,_)),m._13(3,802816,null,0,A.i,[m.Y,m.V,m.y],{ngForOf:[0,"ngForOf"]},null),(n()(),m._32(-1,null,["\n\n"]))],function(n,l){n(l,3,0,l.component.g.plans)},null)}function p(n){return m._34(0,[m._27(0,C,[]),m._27(0,A.d,[m.A]),m._27(0,P,[]),(n()(),m._9(16777216,null,null,1,null,o)),m._13(4,16384,null,0,A.j,[m.Y,m.V],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),m._32(-1,null,["\n"])),(n()(),m._9(0,[["wait4me",2]],null,0,null,i)),(n()(),m._32(-1,null,["\n\n\n"])),(n()(),m._9(16777216,null,null,1,null,f)),m._13(9,16384,null,0,A.j,[m.Y,m.V],{ngIf:[0,"ngIf"]},null)],function(n,l){var u=l.component;n(l,4,0,u.g.me,m._26(l,6)),n(l,9,0,u.g.plans)},null)}function g(n){return m._34(0,[(n()(),m._15(0,0,null,null,2,"app-home",[],null,null,null,p,Y)),m._29(512,null,F,F,[m.G]),m._13(2,114688,null,0,U,[F,D,w.k],null,null)],function(n,l){n(l,2,0)},null)}function h(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),m._32(-1,null,["ng4 365 planner"])),(n()(),m._32(-1,null,["\n\n"])),(n()(),m._32(-1,null,["\n\n"])),(n()(),m._15(4,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),m._13(5,212992,null,0,w.m,[w.b,m.Y,m.k,[8,null],m.i],null,null),(n()(),m._32(-1,null,["\n\n"]))],function(n,l){n(l,5,0)},null)}function d(n){return m._34(0,[(n()(),m._15(0,0,null,null,1,"app-root",[],null,null,null,h,B)),m._13(1,49152,null,0,k,[],null,null)],null,null)}Object.defineProperty(l,"__esModule",{value:!0});var m=u("/oeL"),b={production:!0},y=function(){function n(){}return n}(),k=function(){function n(){}return n}(),v=[""],w=u("BkNc"),D=function(){function n(){this.d=null!=sessionStorage.tokenExpires&&sessionStorage.tokenExpires.length>0?new Date(parseInt(sessionStorage.tokenExpires)):new Date(0),this.isAuthenticated=null!=sessionStorage.accessToken&&sessionStorage.accessToken.length>0&&this.d>new Date,this.cryptObj=window.crypto||window.msCrypto,this.appConfig={authEndpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize?",redirectUri:"https://bresleveloper.github.io/bdi/",appId:"3067a4a4-b49f-41ea-8eb4-595f78ab792f",scopes:"openid People.Read profile Tasks.Read Tasks.Read.Shared User.Read User.ReadBasic.All Directory.Read.All Group.Read.All"},console.log("LoginOAuth2Service CTOR, isAuthenticated :: "+this.isAuthenticated)}return n.prototype.guid=function(){function n(n){for(var l=n.toString(16);l.length<4;)l="0"+l;return l}var l=new Uint16Array(8);return this.cryptObj.getRandomValues(l),n(l[0])+n(l[1])+"-"+n(l[2])+"-"+n(l[3])+"-"+n(l[4])+"-"+n(l[5])+n(l[6])+n(l[7])},n.prototype.buildAuthUrl=function(){sessionStorage.authState=this.guid(),sessionStorage.authNonce=this.guid();var n={response_type:"id_token token",client_id:this.appConfig.appId,redirect_uri:this.appConfig.redirectUri,scope:this.appConfig.scopes,state:sessionStorage.authState,nonce:sessionStorage.authNonce,response_mode:"fragment"};return this.appConfig.authEndpoint+function(n){return Object.keys(n).map(function(l){return encodeURIComponent(l)+"="+encodeURIComponent(n[l])}).join("&")}(n)},n.ctorParameters=function(){return[]},n}(),j=function(){function n(n,l){this.s=n,this.router=l,n.isAuthenticated&&this.router.navigate(["/Home"])}return n.prototype.ngAfterViewInit=function(){this.connectBtn.nativeElement.href=this.s.buildAuthUrl()},n.ctorParameters=function(){return[{type:D},{type:w.k}]},n}(),S=[v],x=m._12({encapsulation:0,styles:S,data:{}}),I=m._10("login",j,e,{},{},[]),O=[""],A=u("qbdv"),C=function(){function n(){}return n.prototype.transform=function(n,l){if(l&&0!=l.length){var u=l.filter(function(l){return l.id==n});return u.length>0?u[0].displayName:"Group System User"}},n}(),P=function(){function n(){}return n.prototype.transform=function(n){if(n){for(var l=Object.keys(n),u=[],t=0;t<l.length;t++)u.push({key:l[t],value:n[l[t]]});return u}},n}(),R=function(){function n(){}return n}(),T=(u("xpf9"),u("5v8a"),u("7u+W"),u("bKpL")),N=u("/v1r"),F=function(){function n(n){var l=this;this.zone=n,this.isAuthenticated=null!=sessionStorage.accessToken&&sessionStorage.accessToken.length>0,this.url="https://graph.microsoft.com/v1.0",this.dataReady=!1,console.log("GraphService CTOR"),this.getData("me","me"),this.getData("users","users"),this.getData("me/Planner/Plans","plans").subscribe(function(n){for(var u=0;u<n.length;u++)l.getPlanData(n[u])})}return n.prototype.getPlanData=function(n){var l=this;console.log("getPlanData for "+n.title);var u="planner/plans/"+n.id+"/";this.getData(u+"details").subscribe(function(u){l.zone.run(function(){return n.details=u}),l.setNlog(u,"details for "+n.title)}),this.getData(u+"buckets").subscribe(function(u){l.zone.run(function(){return n.buckets=u}),l.setNlog(u,"buckets for "+n.title)})},n.prototype.getData=function(n,l){var u=this,t=this.getClient();return T.Observable.fromPromise(t.api(n).get().then(function(n){var t=n.value?n.value:n;return l&&u.setNlog(t,l),t}))},n.prototype.setNlog=function(n,l){this[l]=n,console.log("GraphService[setNlog] - subscribe for :: "+l),console.log(this[l])},n.prototype.getClient=function(){return N.Client.init({authProvider:function(n){n(null,sessionStorage.accessToken)}})},n.ctorParameters=function(){return[{type:m.G}]},n}(),U=function(){function n(n,l,u){this.g=n,this.s=l,this.router=u,0==l.isAuthenticated&&this.router.navigate(["/Login"])}return n.prototype.ngOnInit=function(){},n.ctorParameters=function(){return[{type:F},{type:D},{type:w.k}]},n}(),E=[O],Y=m._12({encapsulation:0,styles:E,data:{}}),$=m._10("app-home",U,g,{},{},[]),G=[""],V=[G],B=m._12({encapsulation:0,styles:V,data:{}}),L=m._10("app-root",k,d,{},{},[]),z=u("fc+i"),q=u("CPp0"),H=function(){function n(){}return n}(),M=m._11(y,[k],function(n){return m._24([m._25(512,m.k,m._7,[[8,[I,$,L]],[3,m.k],m.E]),m._25(5120,m.A,m._23,[[3,m.A]]),m._25(4608,A.l,A.k,[m.A]),m._25(5120,m.c,m._16,[]),m._25(5120,m.y,m._21,[]),m._25(5120,m.z,m._22,[]),m._25(4608,z.b,z.s,[A.c]),m._25(6144,m.Q,null,[z.b]),m._25(4608,z.e,z.f,[]),m._25(5120,z.c,function(n,l,u,t){return[new z.k(n),new z.o(l),new z.n(u,t)]},[A.c,A.c,A.c,z.e]),m._25(4608,z.d,z.d,[z.c,m.G]),m._25(135680,z.m,z.m,[A.c]),m._25(4608,z.l,z.l,[z.d,z.m]),m._25(6144,m.O,null,[z.l]),m._25(6144,z.p,null,[z.m]),m._25(4608,m.W,m.W,[m.G]),m._25(4608,z.g,z.g,[A.c]),m._25(4608,z.i,z.i,[A.c]),m._25(4608,q.c,q.c,[]),m._25(4608,q.g,q.b,[]),m._25(5120,q.i,q.j,[]),m._25(4608,q.h,q.h,[q.c,q.g,q.i]),m._25(4608,q.f,q.a,[]),m._25(5120,q.d,q.k,[q.h,q.f]),m._25(5120,w.a,w.v,[w.k]),m._25(4608,w.d,w.d,[]),m._25(6144,w.f,null,[w.d]),m._25(135680,w.n,w.n,[w.k,m.D,m.j,m.w,w.f]),m._25(4608,w.e,w.e,[]),m._25(5120,w.h,w.y,[w.w]),m._25(5120,m.b,function(n){return[n]},[w.h]),m._25(4608,D,D,[]),m._25(512,A.b,A.b,[]),m._25(1024,m.o,z.q,[]),m._25(1024,m.F,function(){return[w.r()]},[]),m._25(512,w.w,w.w,[m.w]),m._25(1024,m.d,function(n,l,u){return[z.r(n,l),w.x(u)]},[[2,z.h],[2,m.F],w.w]),m._25(512,m.e,m.e,[[2,m.d]]),m._25(131584,m._14,m._14,[m.G,m._8,m.w,m.o,m.k,m.e]),m._25(2048,m.g,null,[m._14]),m._25(512,m.f,m.f,[m.g]),m._25(512,z.a,z.a,[[3,z.a]]),m._25(512,q.e,q.e,[]),m._25(1024,w.q,w.t,[[3,w.k]]),m._25(512,w.p,w.c,[]),m._25(512,w.b,w.b,[]),m._25(256,w.g,{},[]),m._25(1024,A.h,w.s,[A.n,[2,A.a],w.g]),m._25(512,A.g,A.g,[A.h]),m._25(512,m.j,m.j,[]),m._25(512,m.D,m.T,[m.j,[2,m.U]]),m._25(1024,w.i,function(){return[[{path:"",redirectTo:"/Login",pathMatch:"full"},{path:"Login",component:j},{path:"Home",component:U}]]},[]),m._25(1024,w.k,w.u,[m.g,w.p,w.b,A.g,m.w,m.D,m.j,w.i,w.g,[2,w.o],[2,w.j]]),m._25(512,w.l,w.l,[[2,w.q],[2,w.k]]),m._25(512,H,H,[]),m._25(512,R,R,[]),m._25(512,y,y,[])])});b.production&&Object(m._2)(),Object(z.j)().bootstrapModuleFactory(M).catch(function(n){return console.log(n)})},gFIY:function(n,l){function u(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}u.keys=function(){return[]},u.resolve=u,n.exports=u,u.id="gFIY"}},[0]);